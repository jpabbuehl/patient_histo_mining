?rcorr
data<-as.matrix(HighTumorInfLN_data[,9:74])
correlation<-rcorr(data)
correlation
str(data)
dim(data)
data$r
correlation<-rcorr(data)
correlation$r
correlation$P
data<-as.matrix(HighTumorInfLN_data[,9:74])
data<-rcorr(data)
corrplot(data$r,method="color",type="full",order="hclust", col=col1(100),addrect=11,tl.col = "black",addgrid.col = "gray50",diag=FALSE,tl.cex=1, cl.pos = "b",cl.cex=3,cl.offset=0.1)
col1 <- colorRampPalette(c("green", "white", "red"))
corrplot(data$r,method="color",type="full",order="hclust", col=col1(100),addrect=11,tl.col = "black",addgrid.col = "gray50",diag=FALSE,tl.cex=1, cl.pos = "b",cl.cex=3,cl.offset=0.1)
library(devtools)
install_github(username='SachaEpskamp',repos='qgraph')
install_github(username='SachaEpskamp',repo='qgraph')
library(qgrpah)
library(qgraph)
data
Q<-qgraph(data,minimum=.25,cut=4,vsize=2,legend=TRUE,borders=FALSE)
Q<-qgraph(data$r,minimum=.25,cut=4,vsize=2,legend=TRUE,borders=FALSE)
Q<-qgraph(data$r,minimum=.25,cut=4,vsize=2,legend=TRUE,borders=FALSE,layout='spring')
Q<-qgraph(data$r,minimum=.25,cut=4,vsize=2,borders=FALSE,layout='spring')
Q<-qgraph(data$r,minimum=.25,cut=4,vsize=15,borders=FALSE,layout='spring')
Q<-qgraph(data$r,minimum=.25,cut=2,vsize=15,borders=FALSE,layout='spring')
Q<-qgraph(data$r,minimum=.25,cut=.4,vsize=2,borders=FALSE,layout='spring')
Q<-qgraph(data$r,minimum=.25,cut=.4,vsize=1,borders=FALSE,layout='spring')
Q<-qgraph(data$r,minimum=.25,cut=.1,vsize=1,borders=FALSE,layout='spring')
Q<-qgraph(data$r,minimum=.25,cut=.1,vsize=0.4,borders=FALSE,layout='spring')
Q<-qgraph(data$r,minimum=.25,cut=0.4,vsize=2,borders=FALSE,layout='spring')
Q<-qgraph(data$r,minimum=.25,cut=0.4,vsize=2,borders=FALSE,layout='spring')
Q<-qgraph(data$r,minimum=.8,cut=0.4,vsize=2,borders=FALSE,layout='spring')
?qgraph
Q<-qgraph(data$r,minimum=.1,vsize=2,borders=FALSE,layout='spring')
Q<-qgraph(data$r,minimum=.4,vsize=2,borders=FALSE,layout='spring')
Q<-qgraph(data$r,minimum=.4,vsize=2,layout='spring')
Q<-qgraph(data$r,minimum=.4,vsize=2,layout='spring',threshold=.4)
?rcorr
?rcorr
Q<-qgraph(data$r,minimum=.4,vsize=2,layout='spring',threshold=.4)
data$r
grepl('CD4.T',colnames(data$r))
grepl('CD4.T',rownames(data$r))
grepl('CD4.T',rownames(data$r)),grepl('CD4.c',colnames(data$r))
data$r[grepl('CD4.T',rownames(data$r)),grepl('CD4.c',colnames(data$r))]
Q<-qgraph(data$r,minimum=.4,vsize=2,layout='spring',threshold=.4,cut=.4)
Q<-qgraph(data$r,minimum=.4,vsize=2,layout='spring',threshold=.4,cut=.9)
Q<-qgraph(data$r,minimum=.4,vsize=2,layout='spring',threshold=.4)
Q<-qgraph(data$r,minimum=.4,vsize=2,layout='spring',threshold=.6)
data$r[grepl('IDO.L',rownames(data$r)),grepl('FxP3',colnames(data$r))]
data$r[grepl('FP3..L',rownames(data$r)),grepl('FxP3',colnames(data$r))]
data$r[grepl('FP3..L',rownames(data$r)),grepl('Pdpln',colnames(data$r))]
data$r[grepl('FP3.L',rownames(data$r)),grepl('Pdpln',colnames(data$r))]
data$r[grepl('FP3.L',rownames(data$r)),]
data$r[grepl('CD4.s',rownames(data$r)),grepl('iNOS.c',colnames(data$r))]
Q<-qgraph(data$r,minimum=.8,vsize=2,layout='spring',threshold=.6)
Q<-qgraph(data$r,minimum=.8,vsize=2,layout='spring',threshold=.8)
Q<-qgraph(data$r,minimum=.8,vsize=20,layout='spring',threshold=.8)
Q<-qgraph(data$r,minimum=.8,vsize=5,layout='spring',threshold=.8)
Q<-qgraph(data$r,minimum=.8,vsize=3,layout='spring',threshold=.8)
Q<-qgraph(data$r,minimum=.8,vsize=3,layout='spring',threshold=.6)
Q<-qgraph(data$r,minimum=.8,vsize=3,layout='spring',threshold=.8)
Q<-qgraph(data$r,minimum=.8,vsize=3,layout='spring',threshold=.5)
Q<-qgraph(data$r,minimum=.8\,vsize=3,layout='spring',threshold=.5)
Q<-qgraph(data$r,minimum=.8,vsize=3,layout='spring',threshold=.5)
Q<-qgraph(data$r,minimum=.8,cut=.8vsize=3,layout='spring',threshold=.5)
Q<-qgraph(data$r,minimum=.8,cut=.8,vsize=3,layout='spring',threshold=.5)
Q<-qgraph(data$r,minimum=.8,cut=.8,vsize=3,layout='spring',threshold=.8)
Q<-qgraph(data$r,minimum=.9,cut=.8,vsize=3,layout='spring',threshold=.8)
Q<-qgraph(data$r,minimum=.9,cut=.10,vsize=3,layout='spring',threshold=.8)
Q<-qgraph(data$r,minimum=.9,cut=.9,vsize=3,layout='spring',threshold=.8)
?layout
Q<-qgraph(data$r,minimum=.9,cut=.9,vsize=3,,threshold=.8)
Q<-qgraph(data$r,minimum=.9,cut=.9,vsize=3,threshold=.8)
Q<-qgraph(data$r,minimum=.8,cut=.9,vsize=3,threshold=.8)
Q<-qgraph(data$r,minimum=.8,cut=.95,vsize=3,threshold=.8)
data(big5)
data(big5groups)
big5groups
dim(big5)
colnames(data)
colnames(data$)
colnames(data$r)
col1 <- colorRampPalette(c("red", "white", "green"))
corrplot(data$r,method="color",type="full",order="hclust", col=col1(100),addrect=11,tl.col = "black",addgrid.col = "gray50",diag=FALSE,tl.cex=1, cl.pos = "b",cl.cex=3,cl.offset=0.1)
corrplot(data$r,method="color",type="full",order="hclust", col=col1(100),tl.col = "black",addgrid.col = "gray50",diag=FALSE,tl.cex=1, cl.pos = "b",cl.cex=3,cl.offset=0.1)
cor.mtest <- function(mat, conf.level = 0.95) {
mat <- as.matrix(mat)
n <- ncol(mat)
p.mat <- lowCI.mat <- uppCI.mat <- matrix(NA, n, n)
diag(p.mat) <- 0
diag(lowCI.mat) <- diag(uppCI.mat) <- 1
for (i in 1:(n - 1)) {
for (j in (i + 1):n) {
tmp <- cor.test(mat[, i], mat[, j], conf.level = conf.level)
p.mat[i, j] <- p.mat[j, i] <- tmp$p.value
lowCI.mat[i, j] <- lowCI.mat[j, i] <- tmp$conf.int[1]
uppCI.mat[i, j] <- uppCI.mat[j, i] <- tmp$conf.int[2]
}
}
return(list(p.mat, lowCI.mat, uppCI.mat))
}
confidence<-cor.mtest(data$r, 0.95)[[1]]
head(confidence)
str(data)
data$P
head(confidence)
data$P
corrplot(data$r,method="color",type="full",order="hclust",
corrplot(data$r,method="color",type="full",order="hclust",p.mat = data$P, insig = "blank",col=col1(100),tl.col = "black",addgrid.col = "gray50",diag=FALSE,tl.cex=1, cl.pos = "b",cl.cex=3,cl.offset=0.1)
?corrplot
corrplot(data$r,method="color",type="full",order="hclust",p.mat = data$P, insig = "blank",col=col1(100),tl.col = "black",addgrid.col = "gray50",diag=FALSE,tl.cex=1, cl.pos = "b",cl.cex=3,cl.offset=0.1,sig.level = 0.1)
dev.off()
dev.off()
tiff(filename = "HighTumorInfLN correlation map.tiff", width =2000, height = 2000,
units = "px", pointsize = 12, bg = "white", res = NA)
corrplot(data$r,method="color",type="full",order="hclust",p.mat = data$P, insig = "blank",col=col1(100),tl.col = "black",addgrid.col = "gray50",diag=FALSE,tl.cex=1, cl.pos = "b",cl.cex=3,cl.offset=0.1,sig.level = 0.1)
dev.off()
tiff(filename = "HighTumorInfLN correlation map without pval.tiff", width =2000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
corrplot(data$r,method="color",type="full",order="hclust",col=col1(100),tl.col = "black",addgrid.col = "gray50",diag=FALSE,tl.cex=1, cl.pos = "b",cl.cex=3,cl.offset=0.1)
dev.off()
big5groups
colnames(data$r)
rownames(data$r)
staining_groups<-list(HMB45=c(1:6),MelanA=c(7:12),CD8=c(13:18),CD4=c(19:24),CD19=c(25,30),FoxP3=c(31,36),Podoplanin=c(37:42),Prox1=c(43,48),VEGFc=c(49,54),IDO=c(55,60),iNOS=c(61,66))
Q<-qgraph(data$r,minimum=0.8,cut=0.8,threshold=0.8,vsize=2,groups=staining_groups)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups)
dim(data$r)
library(qgraph)
staining_groups<-list(HMB45=c(1:6),MelanA=c(7:12),CD8=c(13:18),CD4=c(19:24),CD19=c(25,30),FoxP3=c(31,36),Podoplanin=c(37:42),Prox1=c(43,48),VEGFc=c(49,54),IDO=c(55,60),iNOS=c(61,66))
colnames(data$R)<-sub('HMB45.','',colnames(data$R))
colnames(data$R)<-sub('Melan.A.','',colnames(data$R))
colnames(data$R)<-sub('CD8.','',colnames(data$R))
colnames(data$R)<-sub('CD4.','',colnames(data$R))
colnames(data$R)<-sub('CD19.','',colnames(data$R))
colnames(data$R)<-sub('FoxP3.','',colnames(data$R))
colnames(data$R)<-sub('Podoplanin.','',colnames(data$R))
colnames(data$R)<-sub('Prox.1.','',colnames(data$R))
colnames(data$R)<-sub('VEGF.C.','',colnames(data$R))
colnames(data$R)<-sub('IDO.','',colnames(data$R))
colnames(data$R)<-sub('iNOS.','',colnames(data$R))
rownames(data$R)<-colnames(data$R)
staining_groups<-list(HMB45=c(1:6),MelanA=c(7:12),CD8=c(13:18),CD4=c(19:24),CD19=c(25,30),FoxP3=c(31,36),Podoplanin=c(37:42),Prox1=c(43,48),VEGFc=c(49,54),IDO=c(55,60),iNOS=c(61,66))
colnames(data$r)<-sub('HMB45.','',colnames(data$r))
colnames(data$r)<-sub('Melan.A.','',colnames(data$r))
colnames(data$r)<-sub('CD8.','',colnames(data$r))
colnames(data$r)<-sub('CD4.','',colnames(data$r))
colnames(data$r)<-sub('CD19.','',colnames(data$r))
colnames(data$r)<-sub('FoxP3.','',colnames(data$r))
colnames(data$r)<-sub('Podoplanin.','',colnames(data$r))
colnames(data$r)<-sub('Prox.1.','',colnames(data$r))
colnames(data$r)<-sub('VEGF.C.','',colnames(data$r))
colnames(data$r)<-sub('IDO.','',colnames(data$r))
colnames(data$r)<-sub('iNOS.','',colnames(data$r))
rownames(data$r)<-colnames(data$r)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups)
colnames(data$r)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=10,groups=staining_groups)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=10,groups=staining_groups,layout='spring')
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=2,groups=staining_groups,layout='spring')
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.7,vsize=2,groups=staining_groups,layout='spring')
Q<-qgraph(data$r,minimum=0.9,cut=0.9,threshold=0.7,vsize=2,groups=staining_groups,layout='spring')
Q<-qgraph(data$r,minimum=0.7.,cut=0.9,threshold=0.7,vsize=2,groups=staining_groups,layout='spring')
Q<-qgraph(data$r,minimum=0.7,cut=0.9,threshold=0.7,vsize=2,groups=staining_groups,layout='spring')
Q<-qgraph(data$r,minimum=0.7,cut=0.9,threshold=0.7,vsize=2,groups=staining_groups)
Q<-qgraph(data$r,minimum=0.7,cut=0.9,vsize=2,groups=staining_groups)
Q<-qgraph(data$r,minimum=0.7,vsize=2,groups=staining_groups)
Q<-qgraph(data$r,minimum=0.7,cut=0.9,threshold=0.9,vsize=2,groups=staining_groups)
Q<-qgraph(data$r,minimum=0.7,cut=0.99,threshold=0.9,vsize=2,groups=staining_groups)
Q<-qgraph(data$r,minimum=0.7,cut=0.99,threshold=0.9,vsize=2,groups=staining_groups,layout='circle')
Q<-qgraph(data$r,minimum=0.7,cut=0.99,threshold=0.9,vsize=2,groups=staining_groups,layout='spring')
data$r
as.matrix(data$r)
info<-colnames(data$r)
colnames(data$r)<-seq(1:ncol(data$r))
rownames(data$r)<-colnames(data$r)
Q<-qgraph(data$r,minimum=0.7,cut=0.99,threshold=0.9,vsize=2,groups=staining_groups,layout='spring')
stainings_groups
staining_groups
staining_groups<-list(HMB45=c(1:6),MelanA=c(7:12),CD8=c(13:18),CD4=c(19:24),CD19=c(25:30),FoxP3=c(31:36),Podoplanin=c(37:42),Prox1=c(43:48),VEGFc=c(49:54),IDO=c(55:60),iNOS=c(61:66))
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups)
info
rep(c(1:6),11)
data<-as.matrix(HighTumorInfLN_data[,9:74])
data<-rcorr(data)
staining_groups<-list(HMB45=c(1:6),MelanA=c(7:12),CD8=c(13:18),CD4=c(19:24),CD19=c(25:30),FoxP3=c(31:36),Podoplanin=c(37:42),Prox1=c(43:48),VEGFc=c(49:54),IDO=c(55:60),iNOS=c(61:66))
colnames(data$r)<-sub('HMB45.','',colnames(data$r))
colnames(data$r)<-sub('Melan.A.','',colnames(data$r))
colnames(data$r)<-sub('CD8.','',colnames(data$r))
colnames(data$r)<-sub('CD4.','',colnames(data$r))
colnames(data$r)<-sub('CD19.','',colnames(data$r))
colnames(data$r)<-sub('FoxP3.','',colnames(data$r))
colnames(data$r)<-sub('Podoplanin.','',colnames(data$r))
colnames(data$r)<-sub('Prox.1.','',colnames(data$r))
colnames(data$r)<-sub('VEGF.C.','',colnames(data$r))
colnames(data$r)<-sub('IDO.','',colnames(data$r))
colnames(data$r)<-sub('iNOS.','',colnames(data$r))
rownames(data$r)<-colnames(data$r)
rownames(data$r)
rownames(data$r)<-rep(c('Tumor','Stroma','Caps','resLN','reactCT','Tot'),11)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.85,vsize=3,groups=staining_groups)
Q<-qgraph(data$r,minimum=0.8,cut=0.85,threshold=0.85,vsize=3,groups=staining_groups)
Q<-qgraph(data$r,minimum=0.8,cut=0.95,threshold=0.85,vsize=3,groups=staining_groups)
Q<-qgraph(data$r,minimum=0.85,cut=0.95,threshold=0.85,vsize=3,groups=staining_groups)
Q<-qgraph(data$r,minimum=0.85,cut=0.95,threshold=0.85,vsize=3,groups=staining_groups,layout='spring')
Q<-qgraph(data$r,minimum=0.85,cut=0.95,threshold=0.9,vsize=3,groups=staining_groups,layout='spring')
Q<-qgraph(data$r,minimum=0.85,cut=0.95,threshold=0.9,vsize=2,groups=staining_groups,layout='spring')
Q<-qgraph(data$r,minimum=0.9,cut=0.95,threshold=0.9,vsize=2,groups=staining_groups,layout='spring')
Q<-qgraph(data$r,minimum=0.5,cut=0.95,threshold=0.9,vsize=2,groups=staining_groups,layout='spring')
Q<-qgraph(data$r,minimum=0.5,threshold=0.9,vsize=2,groups=staining_groups,layout='spring')
Q<-qgraph(data$r,minimum=0.5,threshold=0.7,vsize=2,groups=staining_groups,layout='spring')
Q<-qgraph(data$r,minimum=0.5,threshold=0.7,vsize=2,groups=staining_groups,layout='spring')
rownames(data$r)<-rep(c('T','S','C','LN','CT','TO'),11)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups)
colnames(data$r)<-rownames(data$r)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups,borders=FALSE)
title("Big 5 correlations", line = 2.5)
title("Big 5 correlations", line = 50)
title("Big 5 correlations", line = 50)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups,overlay=TRUE)
title("Big 5 correlations", line = 50)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups)
qgraph<-(Q,overlay=TRUE)
qgraph<-qgraph(Q,overlay=TRUE)
colnames(data$r)<-rownames(data$r)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups)
qgraph<-qgraph(Q,overlay=TRUE)
colnames(data$r)<-rownames(data$r)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups)
Q<-qgraph(data$P,graph='sig',minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups)
Q<-qgraph(data$P,graph='sig',vsize=3,groups=staining_groups)
data$P
data$P
Q<-qgraph(data,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups)
title("Big 5 correlations", line = 50)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups)
title("Big 5 correlations", line = 50)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups)
title("Big 5 correlations", line = 50)
qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups)
title("Big 5 correlations", line = 50)
title("Big 5 correlations", line = 5)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups)
title("Big 5 correlations", line = 2.5)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups)
title("High Tumor infiltrated LN Dataset", line = 2.5)
tiff(filename = "HighTumorInfLN correlation circular graph.tiff", width =2000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups)
title("High Tumor infiltrated LN Dataset", line = 2.5)
dev.off()
tiff(filename = "HighTumorInfLN correlation circular graph.tiff", width =2000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups)
title("High Tumor infiltrated LN Dataset", line = 50)
dev.off()
tiff(filename = "HighTumorInfLN correlation circular graph.tiff", width =2000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups)
title("High Tumor infiltrated LN Dataset", line = 0.5)
dev.off()
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups,gui=TRUE)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups,legend.cex=5)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups,legend.cex=3)
tiff(filename = "HighTumorInfLN correlation circular graph.tiff", width =2000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups,legend.cex=3)
title("High Tumor infiltrated LN Dataset", line = 5)
dev.off()
tiff(filename = "HighTumorInfLN correlation circular graph.tiff", width =2000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.8,cut=0.95,threshold=0.9,vsize=3,groups=staining_groups,legend.cex=3)
title("High Tumor infiltrated LN Dataset", line = 5)
dev.off()
dev.off()
Q<-qgraph(data$r,minimum=0.9,threshold=0.9,vsize=3,groups=staining_groups,legend.cex=3)
Q<-qgraph(data$r,minimum=0.9,threshold=0.85,vsize=3,groups=staining_groups,legend.cex=3)
Q<-qgraph(data$r,minimum=0.85,threshold=0.85,vsize=3,groups=staining_groups,legend.cex=3)
title("High Tumor infiltrated LN Dataset", line = 5)
tiff(filename = "HighTumorInfLN correlation circular graph.tiff", width =2000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.85,threshold=0.85,vsize=3,groups=staining_groups,legend.cex=3)
title("High Tumor infiltrated LN Dataset", line = 2.5,cex.main = 5)
dev.off()
tiff(filename = "HighTumorInfLN correlation circular graph.tiff", width =2000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.85,threshold=0.85,vsize=3,groups=staining_groups,legend.cex=3)
title("High Tumor infiltrated LN Dataset", line = 5,cex.main = 10)
dev.off()
Q<-qgraph(data$r,minimum=0.85,threshold=0.85,vsize=3,groups=staining_groups,legend.cex=3)
title("High Tumor infiltrated LN Dataset",cex.main = 10)
tiff(filename = "HighTumorInfLN correlation circular graph.tiff", width =2000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.85,threshold=0.85,vsize=3,groups=staining_groups,legend.cex=3)
title("High Tumor infiltrated LN Dataset",cex.main = 10)
dev.off()
tiff(filename = "HighTumorInfLN correlation circular graph.tiff", width =2000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.85,threshold=0.85,vsize=3,groups=staining_groups,legend.cex=3)
title("High Tumor infiltrated LN Dataset",line=-1,cex.main = 10)
dev.off()
tiff(filename = "HighTumorInfLN correlation circular graph.tiff", width =2000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.85,threshold=0.85,vsize=3,groups=staining_groups,legend.cex=3)
title("High Tumor infiltrated LN Dataset",line=-10,cex.main = 10)
dev.off()
tiff(filename = "HighTumorInfLN correlation circular graph.tiff", width =4000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.85,threshold=0.85,vsize=3,groups=staining_groups,legend.cex=3)
title("High Tumor infiltrated LN Dataset",line=-6,cex.main = 10)
dev.off()
tiff(filename = "HighTumorInfLN correlation circular graph.tiff", width =3000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.85,threshold=0.85,vsize=3,groups=staining_groups,legend.cex=3)
title("High Tumor infiltrated LN Dataset",line=-6,cex.main = 10)
dev.off()
tiff(filename = "HighTumorInfLN correlation circular graph.tiff", width =3000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.85,cut=0.95,threshold=0.85,vsize=3,groups=staining_groups,legend.cex=3)
title("High Tumor infiltrated LN Dataset",line=-6,cex.main = 10)
dev.off()
Q<-qgraph(data$r,minimum=0.85,cut=0.99,threshold=0.85,vsize=3,groups=staining_groups,legend.cex=3)
Q<-qgraph(data$r,minimum=0.85,cut=0.999,threshold=0.85,vsize=3,groups=staining_groups,legend.cex=3)
Q<-qgraph(data$r,minimum=0.85,threshold=0.85,vsize=3,groups=staining_groups,legend.cex=3)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups,legend.cex=3,layout='spring')
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups,legend.cex=3,layout=nx.spring_layout(G,k=0.15,iterations=20))
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups,legend.cex=3,layout='spring',details=TRUE)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups,legend.cex=3
)
)
Q<-qgraph(data$r,minimum=0.8,cut=0.9,threshold=0.8,vsize=3,groups=staining_groups,legend.cex=3)
Q<-qgraph(data$r,minimum=0.8,cut=1,threshold=0.8,vsize=3,groups=staining_groups,legend.cex=3)
Q<-qgraph(data$r,minimum=0.8,cut=.99,threshold=0.8,vsize=3,groups=staining_groups,legend.cex=3)
Q<-qgraph(data$r,minimum=0.8,cut=.95,threshold=0.8,vsize=3,groups=staining_groups,legend.cex=3)
Q<-qgraph(data$r,minimum=0.8,cut=.95,threshold=0.8,vsize=3,groups=staining_groups,legend.cex=3,edge.width=/8)
Q<-qgraph(data$r,minimum=0.8,cut=.95,threshold=0.8,vsize=3,groups=staining_groups,legend.cex=3,edge.width=.8)
Q<-qgraph(data$r,minimum=0.8,cut=.95,threshold=0.8,vsize=3,groups=staining_groups,legend.cex=3,edge.width=.3)
Q<-qgraph(data$r,minimum=0.8,cut=.95,threshold=0.8,vsize=3,groups=staining_groups,legend.cex=3,edge.width=.5)
Q<-qgraph(data$r,minimum=0.8,cut=.95,threshold=0.8,vsize=3,groups=staining_groups,legend.cex=3,edge.width=.5,probabilityEdges=TRUE)
Q<-qgraph(data$r,minimum=0.8,cut=.95,threshold=0.8,vsize=3,groups=staining_groups,legend.cex=3,edge.width=.5,probabilityEdges=TRUE)
tiff(filename = "HighTumorInfLN correlation circular graph.tiff", width =3000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.85,threshold=0.85,vsize=3,groups=staining_groups,legend.cex=3)
title("High Tumor infiltrated LN Dataset",line=-6,cex.main = 10)
dev.off()
tiff(filename = "HighTumorInfLN correlation circular graph.tiff", width =3000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.85,threshold=0.85,cut=0.95,vsize=3,groups=staining_groups,legend.cex=3)
title("High Tumor infiltrated LN Dataset",line=-6,cex.main = 10)
dev.off()
tiff(filename = "HighTumorInfLN correlation circular graph.tiff", width =3000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.85,threshold=0.85,cut=0.95,vsize=3,groups=staining_groups,legend.cex=3,edge.width=.5)
title("High Tumor infiltrated LN Dataset",line=-6,cex.main = 10)
dev.off()
tiff(filename = "HighTumorInfLN correlation circular graph.tiff", width =3000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.8,threshold=0.8,cut=0.95,vsize=3,groups=staining_groups,legend.cex=3,edge.width=.5)
title("High Tumor infiltrated LN Dataset",line=-6,cex.main = 10)
dev.off()
data<-as.matrix(LowTumorInfLN_data[,9:74])
head(data)
data<-as.matrix(LowTumorInfLN_data[,8:73])
head(data)
data<-rcorr(data)
col1 <- colorRampPalette(c("red", "white", "green"))
tiff(filename = "LowTumorInfLN correlation map.tiff", width =2000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
corrplot(data$r,method="color",type="full",order="hclust",p.mat = data$P, insig = "blank",col=col1(100),tl.col = "black",addgrid.col = "gray50",diag=FALSE,tl.cex=1, cl.pos = "b",cl.cex=3,cl.offset=0.1,sig.level = 0.1)
dev.off()
tiff(filename = "LowTumorInfLN correlation map without pval.tiff", width =2000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
corrplot(data$r,method="color",type="full",order="hclust",col=col1(100),tl.col = "black",addgrid.col = "gray50",diag=FALSE,tl.cex=1, cl.pos = "b",cl.cex=3,cl.offset=0.1)
dev.off()
data
colnames(data)
staining_groups<-list(HMB45=c(1:6),MelanA=c(7:12),CD8=c(13:18),CD4=c(19:24),CD19=c(25:30),FoxP3=c(31:36),Podoplanin=c(37:42),Prox1=c(43:48),VEGFc=c(49:54),IDO=c(55:60),iNOS=c(61:66))
colnames(data$r)<-sub('HMB45.','',colnames(data$r))
colnames(data$r)<-sub('Melan.A.','',colnames(data$r))
colnames(data$r)<-sub('CD8.','',colnames(data$r))
colnames(data$r)<-sub('CD4.','',colnames(data$r))
colnames(data$r)<-sub('CD19.','',colnames(data$r))
colnames(data$r)<-sub('FoxP3.','',colnames(data$r))
colnames(data$r)<-sub('Podoplanin.','',colnames(data$r))
colnames(data$r)<-sub('Prox.1.','',colnames(data$r))
colnames(data$r)<-sub('VEGF.C.','',colnames(data$r))
colnames(data$r)<-sub('IDO.','',colnames(data$r))
colnames(data$r)<-sub('iNOS.','',colnames(data$r))
rownames(data$r)<-colnames(data$r)
rownames(data$r)<-rep(c('T','S','C','LN','CT','TO'),11)
colnames(data$r)<-rownames(data$r)
tiff(filename = "LowTumorInfLN correlation circular graph.tiff", width =3000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.8,threshold=0.8,cut=0.95,vsize=3,groups=staining_groups,legend.cex=3,edge.width=.5)
title("Low Tumor infiltrated LN Dataset",line=-6,cex.main = 10)
dev.off()
dev.off()
tiff(filename = "LowTumorInfLN correlation circular graph.tiff", width =3000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.9,threshold=0.9,cut=0.95,vsize=3,groups=staining_groups,legend.cex=3,edge.width=.5)
title("Low Tumor infiltrated LN Dataset",line=-6,cex.main = 10)
dev.off()
dev.off()
tiff(filename = "LowTumorInfLN correlation circular graph.tiff", width =3000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.9,threshold=0.9,cut=0.95,vsize=3,groups=staining_groups,legend.cex=3,edge.width=.1)
title("Low Tumor infiltrated LN Dataset",line=-6,cex.main = 10)
dev.off()
tiff(filename = "LowTumorInfLN correlation circular graph.tiff", width =3000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.9,threshold=0.9,vsize=3,groups=staining_groups,legend.cex=3)
title("Low Tumor infiltrated LN Dataset",line=-6,cex.main = 10)
dev.off()
Q<-qgraph(data$r,minimum=0.9,threshold=0.9,vsize=3,groups=staining_groups,legend.cex=3)
Q<-qgraph(data$r,minimum=0.95,threshold=0.9,vsize=3,groups=staining_groups,legend.cex=3)
Q<-qgraph(data$r,minimum=0.99,threshold=0.9,vsize=3,groups=staining_groups,legend.cex=3)
Q<-qgraph(data$r,minimum=0.99,threshold=0.99,vsize=3,groups=staining_groups,legend.cex=3)
data
data$r
LowTumorInfLN_data<-read.table('Low tumor infiltrated LN.csv',head=TRUE,sep=",",row.names=NULL,stringsAsFactors = FALSE)
id<-c(8:ncol(LowTumorInfLN_data))
LowTumorInfLN_data[,id]<-as.numeric(as.character(unlist(LowTumorInfLN_data[,id])))
LowTumorInfLN_data[,8:(ncol(LowTumorInfLN_data)-2)]<-apply(LowTumorInfLN_data[,8:(ncol(LowTumorInfLN_data)-2)],2,function(x){x-median(x,na.rm=TRUE)})
#Recalculate ratio CD8/FoxP3 in tumor and stroma
LowTumorInfLN_data$Ratio.CD8.FoxP3.tumor<-HighTumorInfLN_data$CD8.tumor/HighTumorInfLN_data$FoxP3.tumor
LowTumorInfLN_data$Ratio.CD8.FoxP3.stroma<-HighTumorInfLN_data$CD8.stroma/HighTumorInfLN_data$FoxP3.stroma
data<-as.matrix(LowTumorInfLN_data[,8:73])
data<-rcorr(data)
col1 <- colorRampPalette(c("red", "white", "green"))
tiff(filename = "LowTumorInfLN correlation map.tiff", width =2000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
corrplot(data$r,method="color",type="full",order="hclust",p.mat = data$P, insig = "blank",col=col1(100),tl.col = "black",addgrid.col = "gray50",diag=FALSE,tl.cex=1, cl.pos = "b",cl.cex=3,cl.offset=0.1,sig.level = 0.1)
dev.off()
tiff(filename = "LowTumorInfLN correlation map without pval.tiff", width =2000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
corrplot(data$r,method="color",type="full",order="hclust",col=col1(100),tl.col = "black",addgrid.col = "gray50",diag=FALSE,tl.cex=1, cl.pos = "b",cl.cex=3,cl.offset=0.1)
dev.off()
staining_groups<-list(HMB45=c(1:6),MelanA=c(7:12),CD8=c(13:18),CD4=c(19:24),CD19=c(25:30),FoxP3=c(31:36),Podoplanin=c(37:42),Prox1=c(43:48),VEGFc=c(49:54),IDO=c(55:60),iNOS=c(61:66))
colnames(data$r)<-sub('HMB45.','',colnames(data$r))
colnames(data$r)<-sub('Melan.A.','',colnames(data$r))
colnames(data$r)<-sub('CD8.','',colnames(data$r))
colnames(data$r)<-sub('CD4.','',colnames(data$r))
colnames(data$r)<-sub('CD19.','',colnames(data$r))
colnames(data$r)<-sub('FoxP3.','',colnames(data$r))
colnames(data$r)<-sub('Podoplanin.','',colnames(data$r))
colnames(data$r)<-sub('Prox.1.','',colnames(data$r))
colnames(data$r)<-sub('VEGF.C.','',colnames(data$r))
colnames(data$r)<-sub('IDO.','',colnames(data$r))
colnames(data$r)<-sub('iNOS.','',colnames(data$r))
rownames(data$r)<-colnames(data$r)
rownames(data$r)<-rep(c('T','S','C','LN','CT','TO'),11)
colnames(data$r)<-rownames(data$r)
Q<-qgraph(data$r,minimum=0.9,threshold=0.9,vsize=3,groups=staining_groups,legend.cex=3)
data
data$r
data<-as.matrix(LNresponder[,8:73])
data
data<-rcorr(data)
col1 <- colorRampPalette(c("red", "white", "green"))
tiff(filename = "LN responders correlation map.tiff", width =2000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
corrplot(data$r,method="color",type="full",order="hclust",p.mat = data$P, insig = "blank",col=col1(100),tl.col = "black",addgrid.col = "gray50",diag=FALSE,tl.cex=1, cl.pos = "b",cl.cex=3,cl.offset=0.1,sig.level = 0.1)
dev.off()
tiff(filename = "LN responders correlation map without pval.tiff", width =2000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
corrplot(data$r,method="color",type="full",order="hclust",col=col1(100),tl.col = "black",addgrid.col = "gray50",diag=FALSE,tl.cex=1, cl.pos = "b",cl.cex=3,cl.offset=0.1)
dev.off()
staining_groups<-list(HMB45=c(1:6),MelanA=c(7:12),CD8=c(13:18),CD4=c(19:24),CD19=c(25:30),FoxP3=c(31:36),Podoplanin=c(37:42),Prox1=c(43:48),VEGFc=c(49:54),IDO=c(55:60),iNOS=c(61:66))
staining_groups<-list(HMB45=c(1:6),MelanA=c(7:12),CD8=c(13:18),CD4=c(19:24),CD19=c(25:30),FoxP3=c(31:36),Podoplanin=c(37:42),Prox1=c(43:48),VEGFc=c(49:54),IDO=c(55:60),iNOS=c(61:66))
colnames(data$r)<-sub('HMB45.','',colnames(data$r))
colnames(data$r)<-sub('Melan.A.','',colnames(data$r))
colnames(data$r)<-sub('CD8.','',colnames(data$r))
colnames(data$r)<-sub('CD4.','',colnames(data$r))
colnames(data$r)<-sub('CD19.','',colnames(data$r))
colnames(data$r)<-sub('FoxP3.','',colnames(data$r))
colnames(data$r)<-sub('Podoplanin.','',colnames(data$r))
colnames(data$r)<-sub('Prox.1.','',colnames(data$r))
colnames(data$r)<-sub('VEGF.C.','',colnames(data$r))
colnames(data$r)<-sub('IDO.','',colnames(data$r))
colnames(data$r)<-sub('iNOS.','',colnames(data$r))
rownames(data$r)<-colnames(data$r)
rownames(data$r)<-rep(c('T','S','C','LN','CT','TO'),11)
colnames(data$r)<-rownames(data$r)
tiff(filename = "LN responders correlation circular graph.tiff", width =3000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.9,threshold=0.9,vsize=3,groups=staining_groups,legend.cex=3)
title("Low Tumor infiltrated LN Dataset",line=-6,cex.main = 10)
dev.off()
dev.off()
dev.off()
tiff(filename = "LN responders correlation circular graph.tiff", width =3000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.8,threshold=0.8,cut=0.95,vsize=3,groups=staining_groups,legend.cex=3,edge.width=.5)
title("LN responders dataset",line=-6,cex.main = 10)
dev.off()
Q<-qgraph(data$r,minimum=0.85,threshold=0.85,cut=0.95,vsize=3,groups=staining_groups,legend.cex=3,edge.width=.5)
Q<-qgraph(data$r,minimum=0.9,threshold=0.9,cut=0.95,vsize=3,groups=staining_groups,legend.cex=3,edge.width=.5)
Q<-qgraph(data$r,minimum=0.9,threshold=0.95,cut=0.95,vsize=3,groups=staining_groups,legend.cex=3,edge.width=.5)
Q<-qgraph(data$r,minimum=0.95,threshold=0.95,cut=0.95,vsize=3,groups=staining_groups,legend.cex=3,edge.width=.5)
Q<-qgraph(data$r,minimum=0.95,threshold=0.95,cut=0.99,vsize=3,groups=staining_groups,legend.cex=3,edge.width=.5)
tiff(filename = "LN responders correlation circular graph.tiff", width =3000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.95,threshold=0.95,cut=0.99,vsize=3,groups=staining_groups,legend.cex=3,edge.width=.5)
title("LN responders dataset",line=-6,cex.main = 10)
dev.off()
data<-as.matrix(LN_nonresponder[,9:74])
data<-rcorr(data)
col1 <- colorRampPalette(c("red", "white", "green"))
tiff(filename = "LN responders correlation map.tiff", width =2000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
dev.off()
col1 <- colorRampPalette(c("red", "white", "green"))
tiff(filename = "LN non responders correlation map.tiff", width =2000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
corrplot(data$r,method="color",type="full",order="hclust",p.mat = data$P, insig = "blank",col=col1(100),tl.col = "black",addgrid.col = "gray50",diag=FALSE,tl.cex=1, cl.pos = "b",cl.cex=3,cl.offset=0.1,sig.level = 0.1)
dev.off()
tiff(filename = "LN non responders correlation map without pval.tiff", width =2000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
corrplot(data$r,method="color",type="full",order="hclust",col=col1(100),tl.col = "black",addgrid.col = "gray50",diag=FALSE,tl.cex=1, cl.pos = "b",cl.cex=3,cl.offset=0.1)
dev.off()
staining_groups<-list(HMB45=c(1:6),MelanA=c(7:12),CD8=c(13:18),CD4=c(19:24),CD19=c(25:30),FoxP3=c(31:36),Podoplanin=c(37:42),Prox1=c(43:48),VEGFc=c(49:54),IDO=c(55:60),iNOS=c(61:66))
colnames(data$r)<-sub('HMB45.','',colnames(data$r))
colnames(data$r)<-sub('Melan.A.','',colnames(data$r))
colnames(data$r)<-sub('CD8.','',colnames(data$r))
colnames(data$r)<-sub('CD4.','',colnames(data$r))
colnames(data$r)<-sub('CD19.','',colnames(data$r))
colnames(data$r)<-sub('FoxP3.','',colnames(data$r))
colnames(data$r)<-sub('Podoplanin.','',colnames(data$r))
colnames(data$r)<-sub('Prox.1.','',colnames(data$r))
colnames(data$r)<-sub('VEGF.C.','',colnames(data$r))
colnames(data$r)<-sub('IDO.','',colnames(data$r))
colnames(data$r)<-sub('iNOS.','',colnames(data$r))
rownames(data$r)<-colnames(data$r)
rownames(data$r)<-rep(c('T','S','C','LN','CT','TO'),11)
colnames(data$r)<-rownames(data$r)
Q<-qgraph(data$r,minimum=0.95,threshold=0.95,cut=0.99,vsize=3,groups=staining_groups,legend.cex=3,edge.width=.5)
Q<-qgraph(data$r,minimum=0.8,threshold=0.8,cut=0.95,vsize=3,groups=staining_groups,legend.cex=3,edge.width=.5)
tiff(filename = "LN non responders correlation circular graph.tiff", width =3000, height = 2000,units = "px", pointsize = 12, bg = "white", res = NA)
Q<-qgraph(data$r,minimum=0.8,threshold=0.8,cut=0.95,vsize=3,groups=staining_groups,legend.cex=3,edge.width=.5)
title("LN responders dataset",line=-6,cex.main = 10)
dev.off()
